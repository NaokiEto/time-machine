=========================================
Time-Machine Dynamic Bulk Packet Recorder
=========================================

Time-Machine is a bulk packet recorder with some special 
features for tuning and operation.

For more documentation, research publications, and community contact
information, please see the Time Machines's home page:

	http://www.bro.org/community/time-machine.html

One example way to run is:

sudo timemachine -c etc/timemachine.cfg.in if you are in the time-machine directory

sudo timemachine -r <fullpathnametopcapfile> -c </home/lakers/.ssh/time-machine/etc/timemachine.cfg.in>

To exit, press Ctrl + D

to do the read file, do the full path (pwd)

tcpdump -r class_all_1403831630.092187

tm-query is a python file

use python tm-query to run


sudo ./configure --enable-debug --prefix=/home/lakers/tm

sudo make -j 8

sudo make install


sudo timemachine -r "/home/lakers/tenpack.pcap" -c "/home/lakers/tm/etc/timemachine.cfg"


remote console is for components like network intrusion systems like Bro to run
real-time queries using Time Machine

I guess regular users can also use remote console, but in that case, I'm not entirely
sure what the benefit is. Is it that multiple users can use time machine at once?


sudo ./timemachine -r /home/lakers/randompackets.pcap -c /home/lakers/tm/etc/timemachine.cfg

4 types of connections: connection4, connection3, connection2, and ip


race condition? look at vthree log

bpf_filter? O.o returns -1 when fails?


he has some funny comments XD

i learned about avl tree and pmtud path maximum transmission unit discovery method

checking for cut-off is done in Fifo:addPkt, which is called in Storage.cc addPkt method

setCutOff in parser


IndexField.cc, string IPAddress is one place where IPv6 would need to be implemented

also the string pattern_ipv6

and string pattern ipport (near top of IndexField.cc)


qlen is queue length?

input_q is input queue?

potential race conditions at addEntry?

packet is determined if it matches with a class or not

creates a FIFO list with classes that match a packet

this fifo list contains one class. For how many classes there are in the config file, there are that many Fifo's

Each Fifo contains the packets that match with it

these packets are passed to input queue and are transformed into Index fields

ONce the input queue has more than 10, it signals to index thread

if input queue last packet is older than the oldest packet in the Fifo list and the length of the input queue
is less than the number of entries in the hash table,

then add the last packet to the hash table

then eventually write the hash table term into the disk.

start at definition of capture thread in storage.cc

there are 5 known data structures into play

FIFO memory ring buffer

input queue of IndexField's

pointers for a sorted list/queue that determine the order of the timeouts of each entry in the hash table presumably

the infamous hash table with IndexEntry that doubles as an AVL tree

the writing to files on disk (not really a data structure, but meh, sort of counts)


seems liek the difference between held_bytes and tot_bytes (and simialr with packets) is that held_bytes only counts the bytes that are currently in the
buffer while tot_bytes counts all the bytes, including the ones that were popped from the buffer


